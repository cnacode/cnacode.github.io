<!DOCTYPE html>
<html>
  <head id="head">
    <meta charset="utf-8" />
    <title>Test if Third-Party Cookies are Enabled</title>
    <style type="text/css">
      body {
        color: black;
        background: white none;
      }
      .loading {
        color: #888;
        font-size: 1.5rem;
      }
      .middle {
        text-align: center;
        margin-top: 25%;
      }
      .hidden {
        display: none;
      }
    </style>
    <script type="text/javascript">
      window.testDone = false;
      const html = document.getElementsByTagName("html")[0];

      function setMessageToUser(message) {
        const messageToUser = document.getElementById("messageToUser");
        messageToUser.innerText = message;
      }

      function toggleInstructions() {
        const instructionsElement = document.getElementById("instructions");
        const browserNameElement = document.getElementById("browserName");
        const userAgent = navigator.userAgent.toLowerCase();
        const vendor = navigator.vendor.toLowerCase();

        let browser = "";

        if (userAgent.includes("chrome") && vendor.includes("google")) {
          browser = "chrome";
          if (
            /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(
              userAgent
            )
          ) {
            browser = "chrome mobile";
          }
        }

        if (userAgent.includes("safari") && vendor.includes("apple")) {
          browser = "safari";
          if (
            /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(
              userAgent
            )
          ) {
            browser = "safari mobile";
          }
        }

        if (userAgent.includes("firefox")) {
          browser = "firefox";
          if (
            /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(
              userAgent
            )
          ) {
            browser = "firefox-mobile";
          }
        }

        browserName.innerText = browser;

        switch (browser) {
          case "chrome":
            instructionsElement.innerHTML = `
              <ol>
                <li>Select the Chrome menu icon</li>
                <li>Select Settings.
                <li>Near the bottom of the page, select Show advanced settings.
                <li>In the “Privacy” section, select Content settings.</li>
                <li>Select Allow local data to be set (recommended).
                <li>Select Done.
              </ol>
              <a href="https://akohubteam.medium.com/how-to-enable-third-party-cookies-on-your-browsers-f9a8143b8cc5#:~:text=At%20the%20top%20right%2C%20tap,Allow%20third%2Dparty%20cookies.%E2%80%9D">
                Learn how to enable cookies in all browsers
              </a>
            `;
            break;
          case "chrome mobile":
            instructionsElement.innerHTML = `
              <ol>
                <li>On your Android device, open the Chrome app.</li>
                <li>At the top right, tap More More and then Settings.</li>
                <li>Tap Site settings and then Cookies.</li>
                <li>Next to &ldquo;Cookies,&rdquo; switch the setting on.</li>
                <li>To allow third-party cookies, check the box next to &ldquo;Allow third-party cookies.&rdquo;</li>
              </ol>
              <a href="https://akohubteam.medium.com/how-to-enable-third-party-cookies-on-your-browsers-f9a8143b8cc5#:~:text=At%20the%20top%20right%2C%20tap,Allow%20third%2Dparty%20cookies.%E2%80%9D">
                Learn how to enable cookies in all browsers
            </a>
            `;
            break;
          case "firefox":
            instructionsElement.innerHTML = `
              <ol>
                <li>Click Tools &gt; Options.</li>
                <li>Click Privacy in the top panel.</li>
                <li>Select the checkbox labeled &lsquo;Accept cookies from sites.&rsquo;</li>
                <li>Select the checkbox labeled &lsquo;Accept third-party cookies.&rsquo;</li>
                <li>Click OK.</li>
              </ol>
              <a href="https://akohubteam.medium.com/how-to-enable-third-party-cookies-on-your-browsers-f9a8143b8cc5#:~:text=At%20the%20top%20right%2C%20tap,Allow%20third%2Dparty%20cookies.%E2%80%9D">
                Learn how to enable cookies in all browsers
              </a>
            `;
            break;
          case "safari":
            instructionsElement.innerHTML = `
              <ol>
                <li>Go to the Safari drop-down menu.</li>
                <li>Select Preferences.</li>
                <li>Click Privacy in the top panel.</li>
                <li>Under &lsquo;Block cookies&rsquo; select the option &lsquo;Never.&rsquo;</li>
                <li>For increased security, once you have finished using the site, please change the Privacy setting back to Always.</li>
              </ol>
              <a href="https://akohubteam.medium.com/how-to-enable-third-party-cookies-on-your-browsers-f9a8143b8cc5#:~:text=At%20the%20top%20right%2C%20tap,Allow%20third%2Dparty%20cookies.%E2%80%9D">
                Learn how to enable cookies in all browsers
              </a>
            `;
            break;
          case "safari mobile":
            instructionsElement.innerHTML = `
              <ol>
                <li>Open your <strong>Settings</strong>.</li>
                <li>Scroll down and select <strong>Safari</strong>.</li>
                <li>Under <strong>Privacy &amp; Security</strong>, turn off &ldquo;<strong>Prevent Cross-Site Tracking&rdquo;</strong> and &ldquo;<strong>Block All Cookies&rdquo;</strong>.</li>
              </ol>
              <a href="https://akohubteam.medium.com/how-to-enable-third-party-cookies-on-your-browsers-f9a8143b8cc5#:~:text=At%20the%20top%20right%2C%20tap,Allow%20third%2Dparty%20cookies.%E2%80%9D">
                Learn how to enable cookies in all browsers
              </a>
            `;
            break;
          default:
            instructionsElement.innerHTML = `
              <a href="https://akohubteam.medium.com/how-to-enable-third-party-cookies-on-your-browsers-f9a8143b8cc5#:~:text=At%20the%20top%20right%2C%20tap,Allow%20third%2Dparty%20cookies.%E2%80%9D">
                Learn how to enable cookies in all browsers
              </a>
            `;
        }

        instructionsElement.classList.remove("hidden");
      }

      window.cookieIsReady = function () {
        // At this point, a third-party domain has now attempted to set a cookie
        const step2Url = "https://sinamontazeri.com/test/step2.js.php";
        const step2El = document.createElement("script");

        setMessageToUser("Almost done...");
        // And load the second part of the test (reading the cookie)
        step2El.setAttribute("src", step2Url);
        html.appendChild(step2El);
      };

      window.resultIsReady = function (cookieSuccess) {
        window.testDone = true;
        if (cookieSuccess) {
          setMessageToUser(
            "Third party cookies are functioning in your browser. Thank you for your trust."
          );
        } else {
          toggleInstructions();
          setMessageToUser("Third party cookies appear to be disabled");
        }
      };

      window.setTimeout(function () {
        if (!window.testDone)
          setMessageToUser(
            "Sorry we were unable to finish our tests, please contact support."
          );
      }, 10 * 1000);
    </script>
  </head>
  <body>
    <p id="messageToUser" class="middle">Checking your browser...</p>
    <p id="pleaseEnable" class="hidden middle">
      We need third party cookies to provide a great user experience,
      <br />
      please enable them in your browser
    </p>
    <p id="instructions" class="hidden"></p>
    <h4>how to enable cookies in <span id="browserName"></span></h4>
    <script
      type="text/javascript"
      src="https://sinamontazeri.com/test/step1.js.php"
    ></script>
  </body>
</html>
